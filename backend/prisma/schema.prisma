generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  id          BigInt           @id
  title       String
  handle      String           @unique
  vendor      String
  productType String
  bodyHtml    String?
  status      String? 
  tags        String?
  createdAt   DateTime
  updatedAt   DateTime
  variants    ProductVariant[]
  orderItems  OrderItem[]

  @@map("product")  // maps to lowercase table name in Postgres
}

model ProductVariant {
  id               BigInt   @id
  product          Product  @relation(fields: [productId], references: [id])
  productId        BigInt
  title            String
  sku              String?   @unique
  price            Float
  inventory        Int
  requiresShipping Boolean
  taxable          Boolean
  orderItems       OrderItem[]

  @@map("product_variant")
}

model Customer {
  id             BigInt   @id @default(autoincrement())
  firstName      String?
  lastName       String?
  email          String?  @unique
  acceptsEmail   Boolean
  acceptsSMS     Boolean
  phone          String?
  defaultAddress String?
  city           String?
  provinceCode   String?
  countryCode    String?
  zip            String?
  tags           String?
  taxExempt      Boolean
  orders         Order[]

  @@map("customer")
}

model Order {
  id                  BigInt      @id @default(autoincrement())
  shopifyOrderId      BigInt      @unique
  customer            Customer    @relation(fields: [customerId], references: [id])
  customerId          BigInt
  financialStatus     String
  fulfillmentStatus   String
  acceptsMarketing    Boolean
  currency            String
  subtotal            Float
  shipping            Float
  taxes               Float
  total               Float
  discountCode        String?
  discountAmount      Float?
  shippingMethod      String?
  createdAt           DateTime
  updatedAt           DateTime
  orderItems          OrderItem[]

  @@map("order")
}

model OrderItem {
  id                  BigInt        @id @default(autoincrement())
  order               Order         @relation(fields: [orderId], references: [id])
  orderId             BigInt
  product             Product       @relation(fields: [productId], references: [id])
  productId           BigInt
  variant             ProductVariant @relation(fields: [variantId], references: [id])
  variantId           BigInt
  quantity            Int
  price               Float
  requiresShipping    Boolean
  taxable             Boolean
  fulfillmentStatus   String?

  @@map("order_item")
}
